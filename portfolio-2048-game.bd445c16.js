let e,t,o=document.querySelectorAll(".field-cell"),l=document.querySelector("button"),s=document.querySelector(".game-score"),r=document.querySelector(".message-start"),a=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),i=document.querySelector(".message-container"),u=document.querySelector(".game-score-number"),d=0;var m={};Object.defineProperty(m,"Cell",{get:function(){return c},set:void 0,enumerable:!0,configurable:!0});class c{constructor(e,t){this.x=e,this.y=t,this.valueNum=void 0}}m=c;let h=new class{constructor(){this.board=[];for(let e=0;e<4;e++)for(let t=0;t<4;t++)this.board.push(new m(e,t))}getRandomCell(){let e=this.board.filter(e=>void 0===e.valueNum),t=Math.floor(Math.random()*e.length);return e[t]||void 0}getValues(){return this.board.filter(e=>void 0!==e.valueNum)}addNumber(){let e=this.getRandomCell();e&&(e.valueNum=.9>=Math.random()?2:4)}updateBoard(){this.board.forEach(e=>{let t=void 0!==e.valueNum?e.valueNum:void 0,o=e.x,l=e.y,s=document.getElementById(`${o}-${l}`);void 0!==t?(s.classList.value="",s.classList.add("field-cell"),s.textContent=t,s.classList.add(`field-cell--${t}`),s.classList.toggle("animation-appear")):(s.textContent="",s.classList.value="",s.classList.add("field-cell"))})}getBoardValues(){return this.board.map(e=>e.valueNum)}isGameOver(){if(this.getRandomCell())return!1;for(let e of this.board){let t=this.board.find(t=>t.x===e.x&&t.y===e.y+1),o=this.board.find(t=>t.x===e.x+1&&t.y===e.y);if(t&&t.valueNum===e.valueNum||o&&o.valueNum===e.valueNum)return!1}return!0}};l.removeAttribute("disabled"),r.style.bottom="40%",new Promise(e=>{window.addEventListener("load",()=>{setTimeout(()=>{e()},1e3)})}).then(()=>{r.style.opacity="1",r.style.transform="scale(1.3)",setTimeout(()=>{new Promise(e=>{e()}).then(()=>(r.style.bottom="0%",r.style.transform="scale(1)",new Promise(e=>{setTimeout(()=>{e()},1e3)}))).then(()=>{l.removeAttribute("disabled"),l.style.animation="button-bloom 1s ease"})},1e3)}),e=0,t=0,o.forEach(o=>{o.id=`${e}-${t}`,t<3?t++:(e++,t=0)}),l.addEventListener("click",e=>{i.style.opacity="0",r.style.opacity="0",n.style.bottom="0%",a.style.bottom="0%",r.style.bottom="0%",n.classList.add("hidden"),a.classList.add("hidden"),l.classList.contains("start")?(l.textContent="Restart",l.classList.remove("start"),l.classList.add("restart"),h.addNumber(),h.addNumber(),h.updateBoard()):l.classList.contains("restart")&&(h.getValues().forEach(e=>{e.valueNum=void 0}),h.updateBoard(),l.textContent="Start",l.style.width="100px",l.classList.remove("restart"),l.classList.add("start"),d=0,s.textContent="0")});document.addEventListener("keyup",function e(t){let o=h.board.reduce((e,t)=>(e[t.x]||(e[t.x]=[]),e[t.x].push(t),e),[]),l=h.board.reduce((e,t)=>(e[t.y]||(e[t.y]=[]),e[t.y].push(t),e),[]),r=h.getBoardValues(),m={ArrowLeft:()=>{let e;return e=0,o.forEach(t=>{let o=t.map(e=>e.valueNum).filter(e=>void 0!==e);for(let t=0;t<o.length-1;t++)o[t]===o[t+1]&&(o[t]*=2,e+=o[t],u.textContent=`+${o[t]}`,o.splice(t+1,1));for(;o.length<t.length;)o.push(void 0);for(let e=0;e<t.length;e++)t[e].valueNum=o[e]}),e},ArrowRight:()=>{let e;return e=0,o.forEach(t=>{let o=t.map(e=>e.valueNum).filter(e=>void 0!==e);for(let t=o.length-1;t>0;t--)o[t]===o[t-1]&&(o[t]*=2,e+=o[t],u.textContent=`+${o[t]}`,o.splice(t-1,1));for(;o.length<t.length;)o.unshift(void 0);for(let e=0;e<t.length;e++)t[e].valueNum=o[e]}),e},ArrowDown:()=>{let e;return e=0,l.forEach(t=>{let o=t.map(e=>e.valueNum).filter(e=>void 0!==e);for(let t=o.length-1;t>0;t--)o[t]===o[t-1]&&(o[t]*=2,e+=o[t],u.textContent=`+${o[t]}`,o.splice(t-1,1));for(;o.length<t.length;)o.unshift(void 0);for(let e=0;e<t.length;e++)t[e].valueNum=o[e]}),e},ArrowUp:()=>{let e;return e=0,l.forEach(t=>{let o=t.map(e=>e.valueNum).filter(e=>void 0!==e);for(let t=0;t<o.length-1;t++)o[t]===o[t+1]&&(o[t]*=2,e+=o[t],u.textContent=`+${o[t]}`,o.splice(t+1,1));for(;o.length<t.length;)o.push(void 0);for(let e=0;e<t.length;e++)t[e].valueNum=o[e]}),e}}[t.code];if(!m)return;let c=m(),v=h.getBoardValues();r.some((e,t)=>e!==v[t])&&(c>0&&(s.textContent=d+=c,u.classList.add("animation-number-slide"),setTimeout(()=>{u.classList.remove("animation-number-slide")},800),!0===h.board.some(e=>e.valueNum>=2048)&&(i.style.opacity="1",a.classList.remove("hidden"),setTimeout(()=>{a.style.bottom="40%",a.style.transform="scale(1.3)"},1e3),document.removeEventListener("keyup",e))),h.addNumber(),h.isGameOver()&&(i.style.opacity="1",n.classList.remove("hidden"),n.textContent=`You lose with ${d} score`,setTimeout(()=>{n.style.bottom="40%",n.style.transform="scale(1.3)"},1e3),document.removeEventListener("keyup",e)),h.updateBoard())});
//# sourceMappingURL=portfolio-2048-game.bd445c16.js.map
